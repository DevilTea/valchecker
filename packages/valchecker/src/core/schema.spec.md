# schema.spec.md

Source File: [`./schema.ts`](./schema.ts)
Test File: [`./schema.test.ts`](./schema.test.ts)

## Functionality Summary
- Core schema definitions and utilities for valchecker, including base classes, types, and execution helpers.

## Exported Items
- `DefineSchemaTypes`
    - **Description**: A utility type for defining schema types based on raw parameters.
    - **Input**: A type parameter `P` extending `_RawSchemaTypesParam`.
    - **Output**: A resolved schema types object.
- `ExecutionFailureResult`
    - **Description**: Represents a failure result from schema execution with issues.
    - **Input**: N/A (type definition).
    - **Output**: An object with `issues` array.
- `ExecutionIssue`
    - **Description**: Represents an individual issue from schema execution.
    - **Input**: N/A (type definition).
    - **Output**: An object with `code`, optional `message`, `path`, and `error`.
- `ExecutionResult`
    - **Description**: Union type for success or failure execution results.
    - **Input**: N/A (type definition).
    - **Output**: Either `ExecutionSuccessResult` or `ExecutionFailureResult`.
- `ExecutionSuccessResult`
    - **Description**: Represents a successful schema execution result.
    - **Input**: N/A (type definition).
    - **Output**: An object with `value`.
- `InferAsync`
    - **Description**: Infers the async property from a schema type.
    - **Input**: A schema type.
    - **Output**: Boolean indicating if async.
- `InferExecuteReturn`
    - **Description**: Infers the return type of the execute function for a schema.
    - **Input**: A schema type.
    - **Output**: The execution result type, possibly wrapped in Promise.
- `InferInput`
    - **Description**: Infers the input type from a schema.
    - **Input**: A schema type.
    - **Output**: The input type.
- `InferIssueCode`
    - **Description**: Infers the issue code type from a schema.
    - **Input**: A schema type.
    - **Output**: The issue code string union.
- `InferIsValidReturn`
    - **Description**: Infers the return type of the isValid function for a schema.
    - **Input**: A schema type.
    - **Output**: Boolean or Promise<boolean>.
- `InferMeta`
    - **Description**: Infers the meta type from a schema.
    - **Input**: A schema type.
    - **Output**: The meta type.
- `InferOutput`
    - **Description**: Infers the output type from a schema.
    - **Input**: A schema type.
    - **Output**: The output type.
- `InferTransformed`
    - **Description**: Infers the transformed property from a schema type.
    - **Input**: A schema type.
    - **Output**: Boolean indicating if transformed.
- `SchemaMessage`
    - **Description**: Type for schema messages.
    - **Input**: N/A (type definition).
    - **Output**: A message function or string.
- `SchemaTypes`
    - **Description**: Base schema types interface.
    - **Input**: N/A (type definition).
    - **Output**: An object with async, transformed, meta, input, output, issueCode.
- `UntransformedValSchema`
    - **Description**: Type for untransformed schemas.
    - **Input**: N/A (type definition).
    - **Output**: A schema with transformed: false.
- `ValSchema`
    - **Description**: Type for general schemas.
    - **Input**: N/A (type definition).
    - **Output**: A schema object.
- `AbstractSchema`
    - **Description**: Base class for all schemas, implementing StandardSchemaV1.
    - **Input**: Constructor payload with optional meta and message.
    - **Output**: Schema instance with execute method.
- `execute`
    - **Description**: Executes a schema against a value.
    - **Input**: Schema instance and value.
    - **Output**: Execution result or Promise.
- `implementSchemaClass`
    - **Description**: Implements the schema class with execution logic.
    - **Input**: Class constructor, isTransformed, defaultMessage, execute function.
    - **Output**: Modifies the class prototype.
- `isSuccess`
    - **Description**: Checks if an execution result is successful.
    - **Input**: Execution result.
    - **Output**: Boolean.
- `isValid`
    - **Description**: Validates a value against a schema.
    - **Input**: Schema and value.
    - **Output**: Boolean or Promise<boolean>.
- `prependIssuePath`
    - **Description**: Prepends a path to an execution issue.
    - **Input**: Issue and path array.
    - **Output**: Modified issue with updated path.

## Test Cases
- `DefineSchemaTypes`
    - **Note**: Type-only, not runtime testable.
- `ExecutionFailureResult`
    - **Note**: Type-only, not runtime testable.
- `ExecutionIssue`
    - **Note**: Type-only, not runtime testable.
- `ExecutionResult`
    - **Note**: Type-only, not runtime testable.
- `ExecutionSuccessResult`
    - **Note**: Type-only, not runtime testable.
- `InferAsync`
    - **Note**: Type-only, not runtime testable.
- `InferExecuteReturn`
    - **Note**: Type-only, not runtime testable.
- `InferInput`
    - **Note**: Type-only, not runtime testable.
- `InferIssueCode`
    - **Note**: Type-only, not runtime testable.
- `InferIsValidReturn`
    - **Note**: Type-only, not runtime testable.
- `InferMeta`
    - **Note**: Type-only, not runtime testable.
- `InferOutput`
    - **Note**: Type-only, not runtime testable.
- `InferTransformed`
    - **Note**: Type-only, not runtime testable.
- `SchemaMessage`
    - **Note**: Type-only, not runtime testable.
- `SchemaTypes`
    - **Note**: Type-only, not runtime testable.
- `UntransformedValSchema`
    - **Note**: Type-only, not runtime testable.
- `ValSchema`
    - **Note**: Type-only, not runtime testable.
- `AbstractSchema`
    - **Happy Path Cases**
        - [ ] **[AbstractSchema.happy.1]** Case 1: Instantiate with default payload.
            - **Input**: No payload.
            - **Expected**: Instance created successfully.
        - [ ] **[AbstractSchema.happy.2]** Case 1: Instantiate with meta and message.
            - **Input**: Payload with meta and message.
            - **Expected**: Instance with correct properties.
    - **Edge Cases**
        - [ ] **[AbstractSchema.edge.1]** Case 1: Instantiate with null meta.
            - **Input**: Payload with meta: null.
            - **Expected**: Handles null meta.
    - **Error Cases** (if applicable)
        - [ ] **[AbstractSchema.error.1]** Case 1: Execute without implementation throws.
            - **Input**: Call execute on unimplemented schema.
            - **Expected**: Throws not implemented error.initions and utilities for valchecker, including base classes, types, and execution helpers.
- `execute`
    - **Happy Path Cases**
        - [ ] **[execute.happy.1]** Case 1: Execute a simple success schema.
            - **Input**: Mock schema that succeeds, value.
            - **Expected**: Success result.
        - [ ] **[execute.happy.2]** Case 1: Execute a schema that fails.
            - **Input**: Mock schema that fails, value.
            - **Expected**: Failure result.
    - **Edge Cases**
        - [ ] **[execute.edge.1]** Case 1: Execute with async schema.
            - **Input**: Async schema, value.
            - **Expected**: Promise result.
    - **Error Cases**
        - [ ] **[execute.error.1]** Case 1: Execute throws unknown error.
            - **Input**: Schema that throws, value.
            - **Expected**: Failure with UNKNOWN_ERROR.
- `implementSchemaClass`
    - **Happy Path Cases**
        - [ ] **[implementSchemaClass.happy.1]** Case 1: Implement a basic schema class.
            - **Input**: Class, execute function.
            - **Expected**: Class prototype updated.
    - **Edge Cases**
        - [ ] **[implementSchemaClass.edge.1]** Case 1: Implement with isTransformed.
            - **Input**: Class, isTransformed true, execute.
            - **Expected**: isTransformed returns true.
    - **Error Cases**
        - [ ] **[implementSchemaClass.error.1]** Case 1: Invalid execute function.
            - **Input**: Class, invalid execute.
            - **Expected**: Throws or handles gracefully.
- `isSuccess`
    - **Happy Path Cases**
        - [ ] **[isSuccess.happy.1]** Case 1: Check success result.
            - **Input**: { value: 'test' }.
            - **Expected**: true.
        - [ ] **[isSuccess.happy.2]** Case 1: Check failure result.
            - **Input**: { issues: [] }.
            - **Expected**: false.
    - **Edge Cases**
        - [ ] **[isSuccess.edge.1]** Case 1: Check result with both value and issues (invalid).
            - **Input**: Invalid result object.
            - **Expected**: Based on 'value' in.
- `isValid`
    - **Happy Path Cases**
        - [ ] **[isValid.happy.1]** Case 1: Valid value.
            - **Input**: Schema, valid value.
            - **Expected**: true.
        - [ ] **[isValid.happy.2]** Case 1: Invalid value.
            - **Input**: Schema, invalid value.
            - **Expected**: false.
    - **Edge Cases**
        - [ ] **[isValid.edge.1]** Case 1: Async schema.
            - **Input**: Async schema, value.
            - **Expected**: Promise<boolean>.
- `prependIssuePath`
    - **Happy Path Cases**
        - [ ] **[prependIssuePath.happy.1]** Case 1: Prepend path to issue without path.
            - **Input**: Issue { code: 'test' }, path ['a'].
            - **Expected**: Issue with path ['a'].
        - [ ] **[prependIssuePath.happy.2]** Case 1: Prepend path to issue with existing path.
            - **Input**: Issue { code: 'test', path: ['b'] }, path ['a'].
            - **Expected**: Issue with path ['a', 'b'].
    - **Edge Cases**
        - [ ] **[prependIssuePath.edge.1]** Case 1: Empty path.
            - **Input**: Issue, [].
            - **Expected**: Path unchanged.
